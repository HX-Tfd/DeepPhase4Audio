Start training
GPU available: True (cuda), used: False
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
/home/amaruc/DeepPhase4Audio/.env/lib/python3.12/site-packages/pytorch_lightning/trainer/setup.py:177: GPU available but not used. You can set it by doing `Trainer(accelerator='gpu')`.
wandb: Using wandb-core as the SDK backend.  Please refer to https://wandb.me/wandb-core for more information.
wandb: Currently logged in as: amaruc (amaruc-eth-z-rich). Use `wandb login --relogin` to force relogin
wandb: Tracking run with wandb version 0.19.0
wandb: Run data is saved locally in ./wandb/run-20241230_123717-3jgkthj8
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run T1230-1237_PAEDeep_d0145
wandb: ⭐️ View project at https://wandb.ai/amaruc-eth-z-rich/Deep%20Learning
wandb: 🚀 View run at https://wandb.ai/amaruc-eth-z-rich/Deep%20Learning/runs/3jgkthj8
/home/amaruc/DeepPhase4Audio/.env/lib/python3.12/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:654: Checkpoint directory /home/amaruc/DeepPhase4Audio/logs/checkpoints exists and is not empty.
Number of samples in train split: 41
Number of samples in valid split: 5
Number of samples in test split: 6
┏━━━┳━━━━━━━━━━━┳━━━━━━━━━━┳━━━━━━━━┳━━━━━━━┓
┃   ┃ Name      ┃ Type     ┃ Params ┃ Mode  ┃
┡━━━╇━━━━━━━━━━━╇━━━━━━━━━━╇━━━━━━━━╇━━━━━━━┩
│ 0 │ model     │ PAEDeep  │  371 K │ train │
│ 1 │ loss      │ MSELoss  │      0 │ train │
│ 2 │ stft_loss │ STFTLoss │      0 │ train │
└───┴───────────┴──────────┴────────┴───────┘
Trainable params: 323 K                                                         
Non-trainable params: 48.0 K                                                    
Total params: 371 K                                                             
Total estimated model params size (MB): 1                                       
Modules in train mode: 17                                                       
Modules in eval mode: 0                                                         
SLURM auto-requeueing enabled. Setting signal handlers.
/home/amaruc/DeepPhase4Audio/.env/lib/python3.12/site-packages/torch/utils/data/dataloader.py:617: UserWarning: This DataLoader will create 7 worker processes in total. Our suggested max number of worker in current system is 2, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(
/home/amaruc/DeepPhase4Audio/.env/lib/python3.12/site-packages/torch/nn/modules/conv.py:370: UserWarning: Using padding='same' with even kernel lengths and odd dilation may require a zero-padded copy of the input be created (Triggered internally at ../aten/src/ATen/native/Convolution.cpp:1036.)
  return F.conv1d(
/home/amaruc/DeepPhase4Audio/.env/lib/python3.12/site-packages/pytorch_lightning/loops/fit_loop.py:298: The number of training batches (8) is smaller than the logging interval Trainer(log_every_n_steps=10). Set a lower value for log_every_n_steps if you want to see logs for the training epoch.
`Trainer.fit` stopped: `max_epochs=250` reached.
Epoch 249/249 ━━━━━━━━━━━━━━━━━ 8/8 0:00:04 • 0:00:00 2.27it/s v_num: 8_74      
                                                               loss_train/mse_l…
                                                               6.875e-02        
                                                               loss_train/stft_…
                                                               9.045e-01        
                                                               loss_train/stft_…
                                                               1.961e+00        
                                                               loss_train/total…
                                                               3.005e+00        
FIT Profiler Report

----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
|  Action                                                                                                                                                                      	|  Mean duration (s)	|  Num calls      	|  Total time (s) 	|  Percentage %   	|
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
|  Total                                                                                                                                                                       	|  -              	|  83073          	|  1627.5         	|  100 %          	|
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
|  run_training_epoch                                                                                                                                                          	|  6.4869         	|  250            	|  1621.7         	|  99.643         	|
|  run_training_batch                                                                                                                                                          	|  0.43341        	|  2000           	|  866.82         	|  53.26          	|
|  [LightningModule]PAEDeepModel.optimizer_step                                                                                                                                	|  0.43262        	|  2000           	|  865.23         	|  53.162         	|
|  [Strategy]SingleDeviceStrategy.backward                                                                                                                                     	|  0.32268        	|  2000           	|  645.35         	|  39.652         	|
|  [Strategy]SingleDeviceStrategy.validation_step                                                                                                                              	|  2.3296         	|  251            	|  584.73         	|  35.928         	|
|  [Strategy]SingleDeviceStrategy.training_step                                                                                                                                	|  0.10567        	|  2000           	|  211.34         	|  12.986         	|
|  [Callback]RichProgressBar.on_train_batch_end                                                                                                                                	|  0.00098887     	|  2000           	|  1.9777         	|  0.12152        	|
|  [LightningModule]PAEDeepModel.on_validation_model_zero_grad                                                                                                                 	|  0.0024744      	|  250            	|  0.61861        	|  0.038009       	|
|  [_EvaluationLoop].val_next                                                                                                                                                  	|  0.0021555      	|  251            	|  0.54104        	|  0.033243       	|
|  [Callback]RichProgressBar.on_validation_batch_start                                                                                                                         	|  0.0019667      	|  251            	|  0.49365        	|  0.030331       	|
|  [_TrainingEpochLoop].train_dataloader_next                                                                                                                                  	|  0.00022305     	|  2000           	|  0.4461         	|  0.02741        	|
|  [LightningModule]PAEDeepModel.optimizer_zero_grad                                                                                                                           	|  0.00020671     	|  2000           	|  0.41341        	|  0.025401       	|
|  [Callback]RichProgressBar.on_validation_batch_end                                                                                                                           	|  0.00088555     	|  251            	|  0.22227        	|  0.013657       	|
|  [Callback]ModelCheckpoint{'monitor': 'metrics/MAE_val', 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.on_train_epoch_end       	|  0.00083667     	|  250            	|  0.20917        	|  0.012852       	|
|  [Strategy]SingleDeviceStrategy.batch_to_device                                                                                                                              	|  9.0486e-05     	|  2251           	|  0.20368        	|  0.012515       	|
|  [Callback]RichProgressBar.on_train_epoch_start                                                                                                                              	|  0.00054852     	|  250            	|  0.13713        	|  0.0084256      	|
|  [LightningModule]PAEDeepModel.transfer_batch_to_device                                                                                                                      	|  4.9103e-05     	|  2251           	|  0.11053        	|  0.0067914      	|
|  [LightningModule]PAEDeepModel.configure_gradient_clipping                                                                                                                   	|  4.9577e-05     	|  2000           	|  0.099154       	|  0.0060923      	|
|  [Callback]RichProgressBar.on_validation_epoch_end                                                                                                                           	|  0.00023832     	|  251            	|  0.059818       	|  0.0036754      	|
|  [LightningModule]PAEDeepModel.on_validation_model_eval                                                                                                                      	|  0.00023126     	|  251            	|  0.058046       	|  0.0035665      	|
|  [Callback]RichProgressBar.on_validation_end                                                                                                                                 	|  0.0001565      	|  251            	|  0.039282       	|  0.0024136      	|
|  [LightningModule]PAEDeepModel.lr_scheduler_step                                                                                                                             	|  0.00014812     	|  250            	|  0.037029       	|  0.0022752      	|
|  [Callback]ModelCheckpoint{'monitor': 'metrics/MAE_val', 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.on_train_batch_end       	|  1.6223e-05     	|  2000           	|  0.032445       	|  0.0019935      	|
|  [Callback]RichProgressBar.on_after_backward                                                                                                                                 	|  6.6576e-06     	|  2000           	|  0.013315       	|  0.00081812     	|
|  [Callback]ModelCheckpoint{'monitor': 'metrics/MAE_val', 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.on_validation_end        	|  4.9688e-05     	|  251            	|  0.012472       	|  0.00076629     	|
|  [Callback]RichProgressBar.on_train_epoch_end                                                                                                                                	|  4.4007e-05     	|  250            	|  0.011002       	|  0.00067597     	|
|  [Callback]RichModelSummary.on_fit_start                                                                                                                                     	|  0.0082055      	|  1              	|  0.0082055      	|  0.00050417     	|
|  [Callback]RichProgressBar.on_before_zero_grad                                                                                                                               	|  3.6185e-06     	|  2000           	|  0.0072371      	|  0.00044467     	|
|  [LightningModule]PAEDeepModel.on_before_batch_transfer                                                                                                                      	|  3.0529e-06     	|  2251           	|  0.006872       	|  0.00042224     	|
|  [Callback]RichModelSummary.on_train_batch_end                                                                                                                               	|  3.0591e-06     	|  2000           	|  0.0061181      	|  0.00037591     	|
|  [Callback]RichProgressBar.on_before_backward                                                                                                                                	|  3.0189e-06     	|  2000           	|  0.0060379      	|  0.00037098     	|
|  [Callback]RichProgressBar.on_validation_start                                                                                                                               	|  2.2472e-05     	|  251            	|  0.0056405      	|  0.00034657     	|
|  [Callback]RichProgressBar.on_train_batch_start                                                                                                                              	|  2.4738e-06     	|  2000           	|  0.0049475      	|  0.00030399     	|
|  [Callback]ModelCheckpoint{'monitor': 'metrics/MAE_val', 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.on_after_backward        	|  2.0744e-06     	|  2000           	|  0.0041488      	|  0.00025491     	|
|  [Callback]RichProgressBar.on_before_optimizer_step                                                                                                                          	|  1.9494e-06     	|  2000           	|  0.0038987      	|  0.00023955     	|
|  [Callback]RichProgressBar.teardown                                                                                                                                          	|  0.0038011      	|  1              	|  0.0038011      	|  0.00023355     	|
|  [LightningModule]PAEDeepModel.on_train_batch_start                                                                                                                          	|  1.4851e-06     	|  2000           	|  0.0029701      	|  0.00018249     	|
|  [LightningModule]PAEDeepModel.val_dataloader                                                                                                                                	|  0.0028988      	|  1              	|  0.0028988      	|  0.00017811     	|
|  [LightningModule]PAEDeepModel.on_train_batch_end                                                                                                                            	|  1.3558e-06     	|  2000           	|  0.0027116      	|  0.00016661     	|
|  [Strategy]SingleDeviceStrategy.on_train_batch_start                                                                                                                         	|  1.2943e-06     	|  2000           	|  0.0025886      	|  0.00015905     	|
|  [LightningModule]PAEDeepModel.on_after_batch_transfer                                                                                                                       	|  1.1317e-06     	|  2251           	|  0.0025475      	|  0.00015653     	|
|  [LightningModule]PAEDeepModel.on_after_backward                                                                                                                             	|  1.2716e-06     	|  2000           	|  0.0025431      	|  0.00015626     	|
|  [Callback]RichModelSummary.on_after_backward                                                                                                                                	|  1.2234e-06     	|  2000           	|  0.0024468      	|  0.00015034     	|
|  [LightningModule]PAEDeepModel.on_before_zero_grad                                                                                                                           	|  1.202e-06      	|  2000           	|  0.002404       	|  0.00014771     	|
|  [Callback]RichModelSummary.on_before_zero_grad                                                                                                                              	|  1.0994e-06     	|  2000           	|  0.0021988      	|  0.0001351      	|
|  [LightningModule]PAEDeepModel.on_before_backward                                                                                                                            	|  1.0633e-06     	|  2000           	|  0.0021267      	|  0.00013067     	|
|  [LightningModule]PAEDeepModel.on_before_optimizer_step                                                                                                                      	|  9.9738e-07     	|  2000           	|  0.0019948      	|  0.00012256     	|
|  [Callback]ModelCheckpoint{'monitor': 'metrics/MAE_val', 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.on_before_zero_grad      	|  9.9313e-07     	|  2000           	|  0.0019863      	|  0.00012204     	|
|  [Callback]RichModelSummary.on_before_backward                                                                                                                               	|  9.9229e-07     	|  2000           	|  0.0019846      	|  0.00012194     	|
|  [Callback]ModelCheckpoint{'monitor': 'metrics/MAE_val', 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.on_train_batch_start     	|  9.9069e-07     	|  2000           	|  0.0019814      	|  0.00012174     	|
|  [Callback]RichModelSummary.on_before_optimizer_step                                                                                                                         	|  9.2845e-07     	|  2000           	|  0.0018569      	|  0.00011409     	|
|  [Callback]ModelCheckpoint{'monitor': 'metrics/MAE_val', 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.on_before_backward       	|  9.2143e-07     	|  2000           	|  0.0018429      	|  0.00011323     	|
|  [Callback]RichModelSummary.on_train_batch_start                                                                                                                             	|  9.0223e-07     	|  2000           	|  0.0018045      	|  0.00011087     	|
|  [Callback]ModelCheckpoint{'monitor': 'metrics/MAE_val', 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.on_before_optimizer_step 	|  8.7877e-07     	|  2000           	|  0.0017575      	|  0.00010799     	|
|  [Callback]ModelCheckpoint{'monitor': 'metrics/MAE_val', 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.setup                    	|  0.0016402      	|  1              	|  0.0016402      	|  0.00010078     	|
|  [Callback]RichProgressBar.on_validation_epoch_start                                                                                                                         	|  6.0278e-06     	|  251            	|  0.001513       	|  9.2962e-05     	|
|  [Callback]RichModelSummary.on_validation_start                                                                                                                              	|  5.66e-06       	|  251            	|  0.0014207      	|  8.729e-05      	|
|  [LightningModule]PAEDeepModel.on_validation_start                                                                                                                           	|  5.0661e-06     	|  251            	|  0.0012716      	|  7.8129e-05     	|
|  [Strategy]SingleDeviceStrategy.on_validation_start                                                                                                                          	|  4.671e-06      	|  251            	|  0.0011724      	|  7.2037e-05     	|
|  [Callback]ModelCheckpoint{'monitor': 'metrics/MAE_val', 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.on_validation_batch_end  	|  3.12e-06       	|  251            	|  0.00078313     	|  4.8117e-05     	|
|  [Callback]RichModelSummary.on_validation_batch_start                                                                                                                        	|  3.0072e-06     	|  251            	|  0.00075481     	|  4.6378e-05     	|
|  [Callback]RichModelSummary.on_validation_batch_end                                                                                                                          	|  2.9713e-06     	|  251            	|  0.00074579     	|  4.5824e-05     	|
|  [Callback]RichProgressBar.on_sanity_check_start                                                                                                                             	|  0.00068713     	|  1              	|  0.00068713     	|  4.2219e-05     	|
|  [Callback]RichModelSummary.on_train_epoch_start                                                                                                                             	|  2.7239e-06     	|  250            	|  0.00068097     	|  4.1841e-05     	|
|  [Callback]RichModelSummary.on_validation_epoch_end                                                                                                                          	|  2.3179e-06     	|  251            	|  0.0005818      	|  3.5747e-05     	|
|  [Callback]RichModelSummary.on_validation_end                                                                                                                                	|  2.2041e-06     	|  251            	|  0.00055324     	|  3.3993e-05     	|
|  [LightningModule]PAEDeepModel.configure_optimizers                                                                                                                          	|  0.00053643     	|  1              	|  0.00053643     	|  3.2959e-05     	|
|  [LightningModule]PAEDeepModel.train_dataloader                                                                                                                              	|  0.00045924     	|  1              	|  0.00045924     	|  2.8217e-05     	|
|  [Callback]RichModelSummary.on_train_epoch_end                                                                                                                               	|  1.8061e-06     	|  250            	|  0.00045153     	|  2.7743e-05     	|
|  [LightningModule]PAEDeepModel.on_validation_epoch_end                                                                                                                       	|  1.6753e-06     	|  251            	|  0.00042049     	|  2.5836e-05     	|
|  [LightningModule]PAEDeepModel.on_validation_batch_start                                                                                                                     	|  1.5719e-06     	|  251            	|  0.00039454     	|  2.4241e-05     	|
|  [LightningModule]PAEDeepModel.on_validation_batch_end                                                                                                                       	|  1.4264e-06     	|  251            	|  0.00035803     	|  2.1998e-05     	|
|  [Callback]ModelCheckpoint{'monitor': 'metrics/MAE_val', 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.on_validation_batch_start	|  1.3161e-06     	|  251            	|  0.00033034     	|  2.0297e-05     	|
|  [LightningModule]PAEDeepModel.on_validation_end                                                                                                                             	|  1.2954e-06     	|  251            	|  0.00032514     	|  1.9977e-05     	|
|  [LightningModule]PAEDeepModel.on_train_epoch_start                                                                                                                          	|  1.2779e-06     	|  250            	|  0.00031948     	|  1.963e-05      	|
|  [Callback]ModelCheckpoint{'monitor': 'metrics/MAE_val', 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.on_validation_start      	|  1.2015e-06     	|  251            	|  0.00030158     	|  1.853e-05      	|
|  [Callback]ModelCheckpoint{'monitor': 'metrics/MAE_val', 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.on_validation_epoch_end  	|  1.1338e-06     	|  251            	|  0.00028459     	|  1.7486e-05     	|
|  [Callback]ModelCheckpoint{'monitor': 'metrics/MAE_val', 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.on_train_epoch_start     	|  1.1212e-06     	|  250            	|  0.00028031     	|  1.7223e-05     	|
|  [LightningModule]PAEDeepModel.on_train_epoch_end                                                                                                                            	|  1.0692e-06     	|  250            	|  0.00026729     	|  1.6423e-05     	|
|  [LightningModule]PAEDeepModel.on_validation_epoch_start                                                                                                                     	|  9.6799e-07     	|  251            	|  0.00024296     	|  1.4928e-05     	|
|  [Strategy]SingleDeviceStrategy.on_validation_end                                                                                                                            	|  8.9911e-07     	|  251            	|  0.00022568     	|  1.3866e-05     	|
|  [Callback]ModelCheckpoint{'monitor': 'metrics/MAE_val', 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.on_validation_epoch_start	|  8.5112e-07     	|  251            	|  0.00021363     	|  1.3126e-05     	|
|  [Callback]RichModelSummary.on_validation_epoch_start                                                                                                                        	|  8.2419e-07     	|  251            	|  0.00020687     	|  1.2711e-05     	|
|  [Callback]RichProgressBar.on_sanity_check_end                                                                                                                               	|  0.00012311     	|  1              	|  0.00012311     	|  7.564e-06      	|
|  [Callback]RichProgressBar.on_train_start                                                                                                                                    	|  2.9281e-05     	|  1              	|  2.9281e-05     	|  1.7991e-06     	|
|  [Callback]RichProgressBar.setup                                                                                                                                             	|  1.214e-05      	|  1              	|  1.214e-05      	|  7.4592e-07     	|
|  [Callback]RichModelSummary.on_sanity_check_end                                                                                                                              	|  1.0276e-05     	|  1              	|  1.0276e-05     	|  6.3139e-07     	|
|  [Callback]ModelCheckpoint{'monitor': 'metrics/MAE_val', 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.on_train_start           	|  9.8271e-06     	|  1              	|  9.8271e-06     	|  6.038e-07      	|
|  [Callback]RichModelSummary.setup                                                                                                                                            	|  6.3051e-06     	|  1              	|  6.3051e-06     	|  3.874e-07      	|
|  [Callback]RichProgressBar.on_fit_end                                                                                                                                        	|  6.099e-06      	|  1              	|  6.099e-06      	|  3.7474e-07     	|
|  [Callback]RichModelSummary.on_sanity_check_start                                                                                                                            	|  5.7151e-06     	|  1              	|  5.7151e-06     	|  3.5115e-07     	|
|  [Callback]RichModelSummary.on_train_start                                                                                                                                   	|  5.092e-06      	|  1              	|  5.092e-06      	|  3.1287e-07     	|
|  [Callback]ModelCheckpoint{'monitor': 'metrics/MAE_val', 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.on_fit_start             	|  4.5981e-06     	|  1              	|  4.5981e-06     	|  2.8252e-07     	|
|  [Strategy]SingleDeviceStrategy.on_train_start                                                                                                                               	|  4.382e-06      	|  1              	|  4.382e-06      	|  2.6924e-07     	|
|  [LightningModule]PAEDeepModel.on_train_start                                                                                                                                	|  4.295e-06      	|  1              	|  4.295e-06      	|  2.639e-07      	|
|  [Callback]RichModelSummary.teardown                                                                                                                                         	|  3.604e-06      	|  1              	|  3.604e-06      	|  2.2144e-07     	|
|  [Callback]RichProgressBar.on_fit_start                                                                                                                                      	|  3.14e-06       	|  1              	|  3.14e-06       	|  1.9293e-07     	|
|  [Callback]RichProgressBar.on_train_end                                                                                                                                      	|  2.8219e-06     	|  1              	|  2.8219e-06     	|  1.7339e-07     	|
|  [LightningModule]PAEDeepModel.configure_callbacks                                                                                                                           	|  2.742e-06      	|  1              	|  2.742e-06      	|  1.6848e-07     	|
|  [LightningModule]PAEDeepModel.setup                                                                                                                                         	|  2.4871e-06     	|  1              	|  2.4871e-06     	|  1.5281e-07     	|
|  [Callback]RichProgressBar.on_save_checkpoint                                                                                                                                	|  2.316e-06      	|  1              	|  2.316e-06      	|  1.423e-07      	|
|  [Callback]ModelCheckpoint{'monitor': 'metrics/MAE_val', 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.teardown                 	|  1.654e-06      	|  1              	|  1.654e-06      	|  1.0163e-07     	|
|  [LightningModule]PAEDeepModel.teardown                                                                                                                                      	|  1.581e-06      	|  1              	|  1.581e-06      	|  9.7143e-08     	|
|  [Callback]ModelCheckpoint{'monitor': 'metrics/MAE_val', 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.on_sanity_check_end      	|  1.5e-06        	|  1              	|  1.5e-06        	|  9.2165e-08     	|
|  [LightningModule]PAEDeepModel.on_fit_start                                                                                                                                  	|  1.383e-06      	|  1              	|  1.383e-06      	|  8.4976e-08     	|
|  [Callback]ModelCheckpoint{'monitor': 'metrics/MAE_val', 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.on_sanity_check_start    	|  1.295e-06      	|  1              	|  1.295e-06      	|  7.9569e-08     	|
|  [Callback]RichModelSummary.on_save_checkpoint                                                                                                                               	|  1.2909e-06     	|  1              	|  1.2909e-06     	|  7.9318e-08     	|
|  [Callback]ModelCheckpoint{'monitor': 'metrics/MAE_val', 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.on_save_checkpoint       	|  1.239e-06      	|  1              	|  1.239e-06      	|  7.6128e-08     	|
|  [LightningModule]PAEDeepModel.on_train_end                                                                                                                                  	|  1.195e-06      	|  1              	|  1.195e-06      	|  7.3424e-08     	|
|  [LightningModule]PAEDeepModel.on_fit_end                                                                                                                                    	|  1.1889e-06     	|  1              	|  1.1889e-06     	|  7.3052e-08     	|
|  [Callback]RichModelSummary.on_train_end                                                                                                                                     	|  1.107e-06      	|  1              	|  1.107e-06      	|  6.8017e-08     	|
|  [Strategy]SingleDeviceStrategy.on_train_end                                                                                                                                 	|  1.095e-06      	|  1              	|  1.095e-06      	|  6.728e-08      	|
|  [Callback]RichModelSummary.on_fit_end                                                                                                                                       	|  1.056e-06      	|  1              	|  1.056e-06      	|  6.4884e-08     	|
|  [Callback]ModelCheckpoint{'monitor': 'metrics/MAE_val', 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.on_train_end             	|  9.7603e-07     	|  1              	|  9.7603e-07     	|  5.997e-08      	|
|  [Callback]ModelCheckpoint{'monitor': 'metrics/MAE_val', 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.on_fit_end               	|  8.7195e-07     	|  1              	|  8.7195e-07     	|  5.3575e-08     	|
|  [LightningModule]PAEDeepModel.on_save_checkpoint                                                                                                                            	|  8.6799e-07     	|  1              	|  8.6799e-07     	|  5.3332e-08     	|
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

SLURM auto-requeueing enabled. Setting signal handlers.
Testing ━━━━━━━━━━━━━━━━━━━╸                    1/2 0:00:00 • -:--:-- 0.00it/s 
Traceback (most recent call last):
  File "<frozen runpy>", line 198, in _run_module_as_main
  File "<frozen runpy>", line 88, in _run_code
  File "/home/amaruc/DeepPhase4Audio/src/scripts/train_deep.py", line 89, in <module>
    main()
  File "/home/amaruc/DeepPhase4Audio/src/scripts/train_deep.py", line 85, in main
    trainer.test(model)
  File "/home/amaruc/DeepPhase4Audio/.env/lib/python3.12/site-packages/pytorch_lightning/trainer/trainer.py", line 748, in test
    return call._call_and_handle_interrupt(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/amaruc/DeepPhase4Audio/.env/lib/python3.12/site-packages/pytorch_lightning/trainer/call.py", line 47, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/amaruc/DeepPhase4Audio/.env/lib/python3.12/site-packages/pytorch_lightning/trainer/trainer.py", line 788, in _test_impl
    results = self._run(model, ckpt_path=ckpt_path)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/amaruc/DeepPhase4Audio/.env/lib/python3.12/site-packages/pytorch_lightning/trainer/trainer.py", line 981, in _run
    results = self._run_stage()
              ^^^^^^^^^^^^^^^^^
  File "/home/amaruc/DeepPhase4Audio/.env/lib/python3.12/site-packages/pytorch_lightning/trainer/trainer.py", line 1018, in _run_stage
    return self._evaluation_loop.run()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/amaruc/DeepPhase4Audio/.env/lib/python3.12/site-packages/pytorch_lightning/loops/utilities.py", line 178, in _decorator
    return loop_run(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/amaruc/DeepPhase4Audio/.env/lib/python3.12/site-packages/pytorch_lightning/loops/evaluation_loop.py", line 135, in run
    self._evaluation_step(batch, batch_idx, dataloader_idx, dataloader_iter)
  File "/home/amaruc/DeepPhase4Audio/.env/lib/python3.12/site-packages/pytorch_lightning/loops/evaluation_loop.py", line 396, in _evaluation_step
    output = call._call_strategy_hook(trainer, hook_name, *step_args)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/amaruc/DeepPhase4Audio/.env/lib/python3.12/site-packages/pytorch_lightning/trainer/call.py", line 319, in _call_strategy_hook
    output = fn(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^
  File "/home/amaruc/DeepPhase4Audio/.env/lib/python3.12/site-packages/pytorch_lightning/strategies/strategy.py", line 424, in test_step
    return self.lightning_module.test_step(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/amaruc/DeepPhase4Audio/src/experiments/pae_deep.py", line 147, in test_step
    act = batch[i,0].numpy()
          ~~~~~^^^^^
IndexError: index 1 is out of bounds for dimension 0 with size 1
[1;34mwandb[0m: 🚀 View run [33mT1230-1237_PAEDeep_d0145[0m at: [34mhttps://wandb.ai/amaruc-eth-z-rich/Deep Learning/runs/3jgkthj8[0m
